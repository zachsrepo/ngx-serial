{"modules":[{"ast":{"type":"Program","start":0,"end":12949,"body":[{"type":"ExportNamedDeclaration","start":0,"end":2892,"specifiers":[],"source":null,"attributes":[],"declaration":{"type":"ClassDeclaration","start":7,"end":2892,"id":{"type":"Identifier","start":13,"end":22,"name":"NgxSerial"},"superClass":null,"body":{"type":"ClassBody","start":23,"end":2892,"body":[{"type":"PropertyDefinition","start":29,"end":34,"static":false,"computed":false,"key":{"type":"Identifier","start":29,"end":33,"name":"port"},"value":null},{"type":"PropertyDefinition","start":39,"end":135,"static":false,"computed":false,"key":{"type":"Identifier","start":39,"end":46,"name":"options"},"value":{"type":"ObjectExpression","start":49,"end":134,"properties":[{"type":"Property","start":51,"end":65,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":51,"end":59,"name":"baudRate"},"value":{"type":"Literal","start":61,"end":65,"raw":"9600","value":9600},"kind":"init"},{"type":"Property","start":67,"end":78,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":67,"end":75,"name":"dataBits"},"value":{"type":"Literal","start":77,"end":78,"raw":"8","value":8},"kind":"init"},{"type":"Property","start":80,"end":94,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":80,"end":86,"name":"parity"},"value":{"type":"Literal","start":88,"end":94,"value":"none","raw":"'none'"},"kind":"init"},{"type":"Property","start":96,"end":111,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":96,"end":106,"name":"bufferSize"},"value":{"type":"Literal","start":108,"end":111,"raw":"256","value":256},"kind":"init"},{"type":"Property","start":113,"end":132,"method":false,"shorthand":false,"computed":false,"key":{"type":"Identifier","start":113,"end":124,"name":"flowControl"},"value":{"type":"Literal","start":126,"end":132,"value":"none","raw":"'none'"},"kind":"init"}]}},{"type":"PropertyDefinition","start":150,"end":157,"static":false,"computed":false,"key":{"type":"Identifier","start":150,"end":156,"name":"writer"},"value":null},{"type":"PropertyDefinition","start":162,"end":175,"static":false,"computed":false,"key":{"type":"Identifier","start":162,"end":174,"name":"readFunction"},"value":null},{"type":"PropertyDefinition","start":180,"end":204,"static":false,"computed":false,"key":{"type":"Identifier","start":180,"end":196,"name":"controlCharacter"},"value":{"type":"Literal","start":199,"end":203,"value":"\n","raw":"\"\\n\""}},{"type":"PropertyDefinition","start":209,"end":216,"static":false,"computed":false,"key":{"type":"Identifier","start":209,"end":215,"name":"reader"},"value":null},{"type":"PropertyDefinition","start":221,"end":242,"static":false,"computed":false,"key":{"type":"Identifier","start":221,"end":241,"name":"readableStreamClosed"},"value":null},{"type":"PropertyDefinition","start":247,"end":268,"static":false,"computed":false,"key":{"type":"Identifier","start":247,"end":267,"name":"writableStreamClosed"},"value":null},{"type":"PropertyDefinition","start":273,"end":292,"static":false,"computed":false,"key":{"type":"Identifier","start":273,"end":284,"name":"keepReading"},"value":{"type":"Literal","start":287,"end":291,"value":true,"raw":"true"}},{"type":"MethodDefinition","start":297,"end":540,"static":false,"computed":false,"key":{"type":"Identifier","start":297,"end":308,"name":"constructor"},"value":{"type":"FunctionExpression","start":308,"end":540,"async":false,"generator":false,"id":null,"params":[{"type":"Identifier","start":309,"end":321,"name":"readFunction"},{"type":"Identifier","start":323,"end":330,"name":"options"},{"type":"Identifier","start":332,"end":348,"name":"controlCharacter"}],"body":{"type":"BlockStatement","start":350,"end":540,"body":[{"type":"ExpressionStatement","start":360,"end":393,"expression":{"type":"AssignmentExpression","start":360,"end":392,"operator":"=","left":{"type":"MemberExpression","start":360,"end":377,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":360,"end":364},"property":{"type":"Identifier","start":365,"end":377,"name":"readFunction"}},"right":{"type":"Identifier","start":380,"end":392,"name":"readFunction"}}},{"type":"IfStatement","start":402,"end":450,"test":{"type":"Identifier","start":406,"end":413,"name":"options"},"consequent":{"type":"ExpressionStatement","start":427,"end":450,"expression":{"type":"AssignmentExpression","start":427,"end":449,"operator":"=","left":{"type":"MemberExpression","start":427,"end":439,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":427,"end":431},"property":{"type":"Identifier","start":432,"end":439,"name":"options"}},"right":{"type":"Identifier","start":442,"end":449,"name":"options"}}},"alternate":null},{"type":"IfStatement","start":459,"end":534,"test":{"type":"Identifier","start":463,"end":479,"name":"controlCharacter"},"consequent":{"type":"ExpressionStatement","start":493,"end":534,"expression":{"type":"AssignmentExpression","start":493,"end":533,"operator":"=","left":{"type":"MemberExpression","start":493,"end":514,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":493,"end":497},"property":{"type":"Identifier","start":498,"end":514,"name":"controlCharacter"}},"right":{"type":"Identifier","start":517,"end":533,"name":"controlCharacter"}}},"alternate":null}]},"expression":false},"kind":"constructor"},{"type":"MethodDefinition","start":545,"end":612,"static":false,"computed":false,"key":{"type":"Identifier","start":551,"end":559,"name":"sendData"},"value":{"type":"FunctionExpression","start":559,"end":612,"async":true,"generator":false,"id":null,"params":[{"type":"Identifier","start":560,"end":564,"name":"data"}],"body":{"type":"BlockStatement","start":566,"end":612,"body":[{"type":"ExpressionStatement","start":576,"end":606,"expression":{"type":"AwaitExpression","start":576,"end":605,"argument":{"type":"CallExpression","start":582,"end":605,"optional":false,"callee":{"type":"MemberExpression","start":582,"end":599,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":582,"end":593,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":582,"end":586},"property":{"type":"Identifier","start":587,"end":593,"name":"writer"}},"property":{"type":"Identifier","start":594,"end":599,"name":"write"}},"arguments":[{"type":"Identifier","start":600,"end":604,"name":"data"}]}}}]},"expression":false},"kind":"method"},{"type":"MethodDefinition","start":617,"end":1531,"static":false,"computed":false,"key":{"type":"Identifier","start":623,"end":631,"name":"readLoop"},"value":{"type":"FunctionExpression","start":631,"end":1531,"async":true,"generator":false,"id":null,"params":[],"body":{"type":"BlockStatement","start":634,"end":1531,"body":[{"type":"WhileStatement","start":644,"end":1525,"test":{"type":"LogicalExpression","start":651,"end":689,"operator":"&&","left":{"type":"MemberExpression","start":651,"end":669,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":651,"end":660,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":651,"end":655},"property":{"type":"Identifier","start":656,"end":660,"name":"port"}},"property":{"type":"Identifier","start":661,"end":669,"name":"readable"}},"right":{"type":"MemberExpression","start":673,"end":689,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":673,"end":677},"property":{"type":"Identifier","start":678,"end":689,"name":"keepReading"}}},"body":{"type":"BlockStatement","start":691,"end":1525,"body":[{"type":"VariableDeclaration","start":705,"end":749,"kind":"const","declarations":[{"type":"VariableDeclarator","start":711,"end":748,"id":{"type":"Identifier","start":711,"end":722,"name":"textDecoder"},"init":{"type":"NewExpression","start":725,"end":748,"callee":{"type":"Identifier","start":729,"end":746,"name":"TextDecoderStream"},"arguments":[]}}]},{"type":"ExpressionStatement","start":762,"end":838,"expression":{"type":"AssignmentExpression","start":762,"end":837,"operator":"=","left":{"type":"MemberExpression","start":762,"end":787,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":762,"end":766},"property":{"type":"Identifier","start":767,"end":787,"name":"readableStreamClosed"}},"right":{"type":"CallExpression","start":790,"end":837,"optional":false,"callee":{"type":"MemberExpression","start":790,"end":815,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":790,"end":808,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":790,"end":799,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":790,"end":794},"property":{"type":"Identifier","start":795,"end":799,"name":"port"}},"property":{"type":"Identifier","start":800,"end":808,"name":"readable"}},"property":{"type":"Identifier","start":809,"end":815,"name":"pipeTo"}},"arguments":[{"type":"MemberExpression","start":816,"end":836,"computed":false,"optional":false,"object":{"type":"Identifier","start":816,"end":827,"name":"textDecoder"},"property":{"type":"Identifier","start":828,"end":836,"name":"writable"}}]}}},{"type":"ExpressionStatement","start":851,"end":1037,"expression":{"type":"AssignmentExpression","start":851,"end":1036,"operator":"=","left":{"type":"MemberExpression","start":851,"end":862,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":851,"end":855},"property":{"type":"Identifier","start":856,"end":862,"name":"reader"}},"right":{"type":"CallExpression","start":865,"end":1036,"optional":false,"callee":{"type":"MemberExpression","start":865,"end":1034,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":865,"end":883,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":865,"end":874,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":865,"end":869},"property":{"type":"Identifier","start":870,"end":874,"name":"port"}},"property":{"type":"Identifier","start":875,"end":883,"name":"readable"}},"property":{"type":"Identifier","start":1025,"end":1034,"name":"getReader"}},"arguments":[]}}},{"type":"TryStatement","start":1050,"end":1515,"block":{"type":"BlockStatement","start":1054,"end":1378,"body":[{"type":"WhileStatement","start":1072,"end":1364,"test":{"type":"Literal","start":1079,"end":1083,"value":true,"raw":"true"},"body":{"type":"BlockStatement","start":1085,"end":1364,"body":[{"type":"VariableDeclaration","start":1107,"end":1156,"kind":"const","declarations":[{"type":"VariableDeclarator","start":1113,"end":1155,"id":{"type":"ObjectPattern","start":1113,"end":1128,"properties":[{"type":"Property","start":1115,"end":1120,"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":1115,"end":1120,"name":"value"},"value":{"type":"Identifier","start":1115,"end":1120,"name":"value"},"kind":"init"},{"type":"Property","start":1122,"end":1126,"method":false,"shorthand":true,"computed":false,"key":{"type":"Identifier","start":1122,"end":1126,"name":"done"},"value":{"type":"Identifier","start":1122,"end":1126,"name":"done"},"kind":"init"}]},"init":{"type":"AwaitExpression","start":1131,"end":1155,"argument":{"type":"CallExpression","start":1137,"end":1155,"optional":false,"callee":{"type":"MemberExpression","start":1137,"end":1153,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":1137,"end":1148,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":1137,"end":1141},"property":{"type":"Identifier","start":1142,"end":1148,"name":"reader"}},"property":{"type":"Identifier","start":1149,"end":1153,"name":"read"}},"arguments":[]}}}]},{"type":"IfStatement","start":1177,"end":1241,"test":{"type":"Identifier","start":1181,"end":1185,"name":"done"},"consequent":{"type":"BlockStatement","start":1187,"end":1241,"body":[{"type":"BreakStatement","start":1213,"end":1219,"label":null}]},"alternate":null},{"type":"IfStatement","start":1262,"end":1346,"test":{"type":"Identifier","start":1266,"end":1271,"name":"value"},"consequent":{"type":"BlockStatement","start":1273,"end":1346,"body":[{"type":"ExpressionStatement","start":1299,"end":1324,"expression":{"type":"CallExpression","start":1299,"end":1323,"optional":false,"callee":{"type":"MemberExpression","start":1299,"end":1316,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":1299,"end":1303},"property":{"type":"Identifier","start":1304,"end":1316,"name":"readFunction"}},"arguments":[{"type":"Identifier","start":1317,"end":1322,"name":"value"}]}}]},"alternate":null}]}}]},"handler":{"type":"CatchClause","start":1391,"end":1515,"param":{"type":"Identifier","start":1398,"end":1403,"name":"error"},"body":{"type":"BlockStatement","start":1405,"end":1515,"body":[{"type":"ExpressionStatement","start":1423,"end":1501,"expression":{"type":"CallExpression","start":1423,"end":1500,"optional":false,"callee":{"type":"MemberExpression","start":1423,"end":1436,"computed":false,"optional":false,"object":{"type":"Identifier","start":1423,"end":1430,"name":"console"},"property":{"type":"Identifier","start":1431,"end":1436,"name":"error"}},"arguments":[{"type":"Literal","start":1437,"end":1499,"value":"Read Loop error. Have the serial device been disconnected ? ","raw":"\"Read Loop error. Have the serial device been disconnected ? \""}]}}]}},"finalizer":null}]}}]},"expression":false},"kind":"method"},{"type":"MethodDefinition","start":1536,"end":1814,"static":false,"computed":false,"key":{"type":"Identifier","start":1542,"end":1547,"name":"close"},"value":{"type":"FunctionExpression","start":1547,"end":1814,"async":true,"generator":false,"id":null,"params":[{"type":"Identifier","start":1548,"end":1556,"name":"callback"}],"body":{"type":"BlockStatement","start":1558,"end":1814,"body":[{"type":"ExpressionStatement","start":1568,"end":1593,"expression":{"type":"AssignmentExpression","start":1568,"end":1592,"operator":"=","left":{"type":"MemberExpression","start":1568,"end":1584,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":1568,"end":1572},"property":{"type":"Identifier","start":1573,"end":1584,"name":"keepReading"}},"right":{"type":"Literal","start":1587,"end":1592,"value":false,"raw":"false"}}},{"type":"ExpressionStatement","start":1602,"end":1623,"expression":{"type":"CallExpression","start":1602,"end":1622,"optional":false,"callee":{"type":"MemberExpression","start":1602,"end":1620,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":1602,"end":1613,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":1602,"end":1606},"property":{"type":"Identifier","start":1607,"end":1613,"name":"reader"}},"property":{"type":"Identifier","start":1614,"end":1620,"name":"cancel"}},"arguments":[]}},{"type":"ExpressionStatement","start":1632,"end":1681,"expression":{"type":"AwaitExpression","start":1632,"end":1680,"argument":{"type":"CallExpression","start":1638,"end":1680,"optional":false,"callee":{"type":"MemberExpression","start":1638,"end":1669,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":1638,"end":1663,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":1638,"end":1642},"property":{"type":"Identifier","start":1643,"end":1663,"name":"readableStreamClosed"}},"property":{"type":"Identifier","start":1664,"end":1669,"name":"catch"}},"arguments":[{"type":"ArrowFunctionExpression","start":1670,"end":1679,"async":false,"expression":false,"generator":false,"params":[],"body":{"type":"BlockStatement","start":1676,"end":1679,"body":[]},"id":null}]}}},{"type":"ExpressionStatement","start":1690,"end":1710,"expression":{"type":"CallExpression","start":1690,"end":1709,"optional":false,"callee":{"type":"MemberExpression","start":1690,"end":1707,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":1690,"end":1701,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":1690,"end":1694},"property":{"type":"Identifier","start":1695,"end":1701,"name":"writer"}},"property":{"type":"Identifier","start":1702,"end":1707,"name":"close"}},"arguments":[]}},{"type":"ExpressionStatement","start":1719,"end":1751,"expression":{"type":"AwaitExpression","start":1719,"end":1750,"argument":{"type":"MemberExpression","start":1725,"end":1750,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":1725,"end":1729},"property":{"type":"Identifier","start":1730,"end":1750,"name":"writableStreamClosed"}}}},{"type":"ExpressionStatement","start":1760,"end":1784,"expression":{"type":"AwaitExpression","start":1760,"end":1783,"argument":{"type":"CallExpression","start":1766,"end":1783,"optional":false,"callee":{"type":"MemberExpression","start":1766,"end":1781,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":1766,"end":1775,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":1766,"end":1770},"property":{"type":"Identifier","start":1771,"end":1775,"name":"port"}},"property":{"type":"Identifier","start":1776,"end":1781,"name":"close"}},"arguments":[]}}},{"type":"ExpressionStatement","start":1793,"end":1808,"expression":{"type":"CallExpression","start":1793,"end":1807,"optional":false,"callee":{"type":"Identifier","start":1793,"end":1801,"name":"callback"},"arguments":[{"type":"Literal","start":1802,"end":1806,"raw":"null","value":null}]}}]},"expression":false},"kind":"method"},{"type":"MethodDefinition","start":1819,"end":2890,"static":false,"computed":false,"key":{"type":"Identifier","start":1825,"end":1832,"name":"connect"},"value":{"type":"FunctionExpression","start":1832,"end":2890,"async":true,"generator":false,"id":null,"params":[{"type":"Identifier","start":1833,"end":1841,"name":"callback"}],"body":{"type":"BlockStatement","start":1843,"end":2890,"body":[{"type":"ExpressionStatement","start":1853,"end":1877,"expression":{"type":"AssignmentExpression","start":1853,"end":1876,"operator":"=","left":{"type":"MemberExpression","start":1853,"end":1869,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":1853,"end":1857},"property":{"type":"Identifier","start":1858,"end":1869,"name":"keepReading"}},"right":{"type":"Literal","start":1872,"end":1876,"value":true,"raw":"true"}}},{"type":"IfStatement","start":1886,"end":2884,"test":{"type":"BinaryExpression","start":1890,"end":1911,"operator":"in","left":{"type":"Literal","start":1890,"end":1898,"value":"serial","raw":"\"serial\""},"right":{"type":"Identifier","start":1902,"end":1911,"name":"navigator"}},"consequent":{"type":"BlockStatement","start":1913,"end":2780,"body":[{"type":"VariableDeclaration","start":1990,"end":2010,"kind":"let","declarations":[{"type":"VariableDeclarator","start":1994,"end":2009,"id":{"type":"Identifier","start":1994,"end":1997,"name":"nav"},"init":{"type":"Identifier","start":2000,"end":2009,"name":"navigator"}}]},{"type":"VariableDeclaration","start":2023,"end":2065,"kind":"const","declarations":[{"type":"VariableDeclarator","start":2029,"end":2064,"id":{"type":"Identifier","start":2029,"end":2034,"name":"ports"},"init":{"type":"AwaitExpression","start":2037,"end":2064,"argument":{"type":"CallExpression","start":2043,"end":2064,"optional":false,"callee":{"type":"MemberExpression","start":2043,"end":2062,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":2043,"end":2053,"computed":false,"optional":false,"object":{"type":"Identifier","start":2043,"end":2046,"name":"nav"},"property":{"type":"Identifier","start":2047,"end":2053,"name":"serial"}},"property":{"type":"Identifier","start":2054,"end":2062,"name":"getPorts"}},"arguments":[]}}}]},{"type":"TryStatement","start":2078,"end":2289,"block":{"type":"BlockStatement","start":2082,"end":2157,"body":[{"type":"ExpressionStatement","start":2100,"end":2143,"expression":{"type":"AssignmentExpression","start":2100,"end":2142,"operator":"=","left":{"type":"MemberExpression","start":2100,"end":2109,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":2100,"end":2104},"property":{"type":"Identifier","start":2105,"end":2109,"name":"port"}},"right":{"type":"AwaitExpression","start":2112,"end":2142,"argument":{"type":"CallExpression","start":2118,"end":2142,"optional":false,"callee":{"type":"MemberExpression","start":2118,"end":2140,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":2118,"end":2128,"computed":false,"optional":false,"object":{"type":"Identifier","start":2118,"end":2121,"name":"nav"},"property":{"type":"Identifier","start":2122,"end":2128,"name":"serial"}},"property":{"type":"Identifier","start":2129,"end":2140,"name":"requestPort"}},"arguments":[]}}}}]},"handler":{"type":"CatchClause","start":2170,"end":2289,"param":{"type":"Identifier","start":2177,"end":2182,"name":"error"},"body":{"type":"BlockStatement","start":2184,"end":2289,"body":[{"type":"ExpressionStatement","start":2202,"end":2251,"expression":{"type":"CallExpression","start":2202,"end":2250,"optional":false,"callee":{"type":"MemberExpression","start":2202,"end":2215,"computed":false,"optional":false,"object":{"type":"Identifier","start":2202,"end":2209,"name":"console"},"property":{"type":"Identifier","start":2210,"end":2215,"name":"error"}},"arguments":[{"type":"BinaryExpression","start":2216,"end":2249,"operator":"+","left":{"type":"Literal","start":2216,"end":2241,"value":"Requesting port error: ","raw":"\"Requesting port error: \""},"right":{"type":"Identifier","start":2244,"end":2249,"name":"error"}}]}},{"type":"ReturnStatement","start":2268,"end":2275,"argument":null}]}},"finalizer":null},{"type":"TryStatement","start":2302,"end":2502,"block":{"type":"BlockStatement","start":2306,"end":2373,"body":[{"type":"ExpressionStatement","start":2324,"end":2359,"expression":{"type":"AwaitExpression","start":2324,"end":2358,"argument":{"type":"CallExpression","start":2330,"end":2358,"optional":false,"callee":{"type":"MemberExpression","start":2330,"end":2344,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":2330,"end":2339,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":2330,"end":2334},"property":{"type":"Identifier","start":2335,"end":2339,"name":"port"}},"property":{"type":"Identifier","start":2340,"end":2344,"name":"open"}},"arguments":[{"type":"MemberExpression","start":2345,"end":2357,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":2345,"end":2349},"property":{"type":"Identifier","start":2350,"end":2357,"name":"options"}}]}}}]},"handler":{"type":"CatchClause","start":2386,"end":2502,"param":{"type":"Identifier","start":2393,"end":2398,"name":"error"},"body":{"type":"BlockStatement","start":2400,"end":2502,"body":[{"type":"ExpressionStatement","start":2418,"end":2464,"expression":{"type":"CallExpression","start":2418,"end":2463,"optional":false,"callee":{"type":"MemberExpression","start":2418,"end":2431,"computed":false,"optional":false,"object":{"type":"Identifier","start":2418,"end":2425,"name":"console"},"property":{"type":"Identifier","start":2426,"end":2431,"name":"error"}},"arguments":[{"type":"BinaryExpression","start":2432,"end":2462,"operator":"+","left":{"type":"Literal","start":2432,"end":2454,"value":"Opening port error: ","raw":"\"Opening port error: \""},"right":{"type":"Identifier","start":2457,"end":2462,"name":"error"}}]}},{"type":"ReturnStatement","start":2481,"end":2488,"argument":null}]}},"finalizer":null},{"type":"VariableDeclaration","start":2515,"end":2559,"kind":"const","declarations":[{"type":"VariableDeclarator","start":2521,"end":2558,"id":{"type":"Identifier","start":2521,"end":2532,"name":"textEncoder"},"init":{"type":"NewExpression","start":2535,"end":2558,"callee":{"type":"Identifier","start":2539,"end":2556,"name":"TextEncoderStream"},"arguments":[]}}]},{"type":"ExpressionStatement","start":2572,"end":2648,"expression":{"type":"AssignmentExpression","start":2572,"end":2647,"operator":"=","left":{"type":"MemberExpression","start":2572,"end":2597,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":2572,"end":2576},"property":{"type":"Identifier","start":2577,"end":2597,"name":"writableStreamClosed"}},"right":{"type":"CallExpression","start":2600,"end":2647,"optional":false,"callee":{"type":"MemberExpression","start":2600,"end":2627,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":2600,"end":2620,"computed":false,"optional":false,"object":{"type":"Identifier","start":2600,"end":2611,"name":"textEncoder"},"property":{"type":"Identifier","start":2612,"end":2620,"name":"readable"}},"property":{"type":"Identifier","start":2621,"end":2627,"name":"pipeTo"}},"arguments":[{"type":"MemberExpression","start":2628,"end":2646,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":2628,"end":2637,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":2628,"end":2632},"property":{"type":"Identifier","start":2633,"end":2637,"name":"port"}},"property":{"type":"Identifier","start":2638,"end":2646,"name":"writable"}}]}}},{"type":"ExpressionStatement","start":2661,"end":2708,"expression":{"type":"AssignmentExpression","start":2661,"end":2707,"operator":"=","left":{"type":"MemberExpression","start":2661,"end":2672,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":2661,"end":2665},"property":{"type":"Identifier","start":2666,"end":2672,"name":"writer"}},"right":{"type":"CallExpression","start":2675,"end":2707,"optional":false,"callee":{"type":"MemberExpression","start":2675,"end":2705,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":2675,"end":2695,"computed":false,"optional":false,"object":{"type":"Identifier","start":2675,"end":2686,"name":"textEncoder"},"property":{"type":"Identifier","start":2687,"end":2695,"name":"writable"}},"property":{"type":"Identifier","start":2696,"end":2705,"name":"getWriter"}},"arguments":[]}}},{"type":"ExpressionStatement","start":2721,"end":2737,"expression":{"type":"CallExpression","start":2721,"end":2736,"optional":false,"callee":{"type":"MemberExpression","start":2721,"end":2734,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":2721,"end":2725},"property":{"type":"Identifier","start":2726,"end":2734,"name":"readLoop"}},"arguments":[]}},{"type":"ExpressionStatement","start":2750,"end":2770,"expression":{"type":"CallExpression","start":2750,"end":2769,"optional":false,"callee":{"type":"Identifier","start":2750,"end":2758,"name":"callback"},"arguments":[{"type":"MemberExpression","start":2759,"end":2768,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":2759,"end":2763},"property":{"type":"Identifier","start":2764,"end":2768,"name":"port"}}]}}]},"alternate":{"type":"BlockStatement","start":2794,"end":2884,"body":[{"type":"ExpressionStatement","start":2808,"end":2874,"expression":{"type":"CallExpression","start":2808,"end":2873,"optional":false,"callee":{"type":"MemberExpression","start":2808,"end":2821,"computed":false,"optional":false,"object":{"type":"Identifier","start":2808,"end":2815,"name":"console"},"property":{"type":"Identifier","start":2816,"end":2821,"name":"error"}},"arguments":[{"type":"Literal","start":2822,"end":2872,"value":"This browser does NOT support the Web Serial API","raw":"\"This browser does NOT support the Web Serial API\""}]}}]}}]},"expression":false},"kind":"method"}]}}},{"type":"ClassDeclaration","start":2893,"end":3398,"id":{"type":"Identifier","start":2899,"end":2919,"name":"LineBreakTransformer"},"superClass":null,"body":{"type":"ClassBody","start":2920,"end":3398,"body":[{"type":"PropertyDefinition","start":2926,"end":2941,"static":false,"computed":false,"key":{"type":"Identifier","start":2926,"end":2935,"name":"container"},"value":{"type":"Literal","start":2938,"end":2940,"value":"","raw":"\"\""}},{"type":"PropertyDefinition","start":2946,"end":2963,"static":false,"computed":false,"key":{"type":"Identifier","start":2946,"end":2962,"name":"controlCharacter"},"value":null},{"type":"MethodDefinition","start":2968,"end":3084,"static":false,"computed":false,"key":{"type":"Identifier","start":2968,"end":2979,"name":"constructor"},"value":{"type":"FunctionExpression","start":2979,"end":3084,"async":false,"generator":false,"id":null,"params":[{"type":"Identifier","start":2980,"end":2996,"name":"controlCharacter"}],"body":{"type":"BlockStatement","start":2998,"end":3084,"body":[{"type":"ExpressionStatement","start":3008,"end":3028,"expression":{"type":"AssignmentExpression","start":3008,"end":3027,"operator":"=","left":{"type":"MemberExpression","start":3008,"end":3022,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":3008,"end":3012},"property":{"type":"Identifier","start":3013,"end":3022,"name":"container"}},"right":{"type":"Literal","start":3025,"end":3027,"value":"","raw":"''"}}},{"type":"ExpressionStatement","start":3037,"end":3078,"expression":{"type":"AssignmentExpression","start":3037,"end":3077,"operator":"=","left":{"type":"MemberExpression","start":3037,"end":3058,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":3037,"end":3041},"property":{"type":"Identifier","start":3042,"end":3058,"name":"controlCharacter"}},"right":{"type":"Identifier","start":3061,"end":3077,"name":"controlCharacter"}}}]},"expression":false},"kind":"constructor"},{"type":"MethodDefinition","start":3089,"end":3322,"static":false,"computed":false,"key":{"type":"Identifier","start":3089,"end":3098,"name":"transform"},"value":{"type":"FunctionExpression","start":3098,"end":3322,"async":false,"generator":false,"id":null,"params":[{"type":"Identifier","start":3099,"end":3104,"name":"chunk"},{"type":"Identifier","start":3106,"end":3116,"name":"controller"}],"body":{"type":"BlockStatement","start":3118,"end":3322,"body":[{"type":"ExpressionStatement","start":3128,"end":3152,"expression":{"type":"AssignmentExpression","start":3128,"end":3151,"operator":"+=","left":{"type":"MemberExpression","start":3128,"end":3142,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":3128,"end":3132},"property":{"type":"Identifier","start":3133,"end":3142,"name":"container"}},"right":{"type":"Identifier","start":3146,"end":3151,"name":"chunk"}}},{"type":"VariableDeclaration","start":3161,"end":3219,"kind":"const","declarations":[{"type":"VariableDeclarator","start":3167,"end":3218,"id":{"type":"Identifier","start":3167,"end":3172,"name":"lines"},"init":{"type":"CallExpression","start":3175,"end":3218,"optional":false,"callee":{"type":"MemberExpression","start":3175,"end":3195,"computed":false,"optional":false,"object":{"type":"MemberExpression","start":3175,"end":3189,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":3175,"end":3179},"property":{"type":"Identifier","start":3180,"end":3189,"name":"container"}},"property":{"type":"Identifier","start":3190,"end":3195,"name":"split"}},"arguments":[{"type":"MemberExpression","start":3196,"end":3217,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":3196,"end":3200},"property":{"type":"Identifier","start":3201,"end":3217,"name":"controlCharacter"}}]}}]},{"type":"ExpressionStatement","start":3228,"end":3257,"expression":{"type":"AssignmentExpression","start":3228,"end":3256,"operator":"=","left":{"type":"MemberExpression","start":3228,"end":3242,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":3228,"end":3232},"property":{"type":"Identifier","start":3233,"end":3242,"name":"container"}},"right":{"type":"CallExpression","start":3245,"end":3256,"optional":false,"callee":{"type":"MemberExpression","start":3245,"end":3254,"computed":false,"optional":false,"object":{"type":"Identifier","start":3245,"end":3250,"name":"lines"},"property":{"type":"Identifier","start":3251,"end":3254,"name":"pop"}},"arguments":[]}}},{"type":"ExpressionStatement","start":3266,"end":3316,"expression":{"type":"CallExpression","start":3266,"end":3315,"optional":false,"callee":{"type":"MemberExpression","start":3266,"end":3279,"computed":false,"optional":false,"object":{"type":"Identifier","start":3266,"end":3271,"name":"lines"},"property":{"type":"Identifier","start":3272,"end":3279,"name":"forEach"}},"arguments":[{"type":"ArrowFunctionExpression","start":3280,"end":3314,"async":false,"expression":true,"generator":false,"params":[{"type":"Identifier","start":3281,"end":3285,"name":"line"}],"body":{"type":"CallExpression","start":3290,"end":3314,"optional":false,"callee":{"type":"MemberExpression","start":3290,"end":3308,"computed":false,"optional":false,"object":{"type":"Identifier","start":3290,"end":3300,"name":"controller"},"property":{"type":"Identifier","start":3301,"end":3308,"name":"enqueue"}},"arguments":[{"type":"Identifier","start":3309,"end":3313,"name":"line"}]},"id":null}]}}]},"expression":false},"kind":"method"},{"type":"MethodDefinition","start":3327,"end":3396,"static":false,"computed":false,"key":{"type":"Identifier","start":3327,"end":3332,"name":"flush"},"value":{"type":"FunctionExpression","start":3332,"end":3396,"async":false,"generator":false,"id":null,"params":[{"type":"Identifier","start":3333,"end":3343,"name":"controller"}],"body":{"type":"BlockStatement","start":3345,"end":3396,"body":[{"type":"ExpressionStatement","start":3355,"end":3390,"expression":{"type":"CallExpression","start":3355,"end":3389,"optional":false,"callee":{"type":"MemberExpression","start":3355,"end":3373,"computed":false,"optional":false,"object":{"type":"Identifier","start":3355,"end":3365,"name":"controller"},"property":{"type":"Identifier","start":3366,"end":3373,"name":"enqueue"}},"arguments":[{"type":"MemberExpression","start":3374,"end":3388,"computed":false,"optional":false,"object":{"type":"ThisExpression","start":3374,"end":3378},"property":{"type":"Identifier","start":3379,"end":3388,"name":"container"}}]}}]},"expression":false},"kind":"method"}]}}],"_rollupRemoved":[{"end":12949,"start":3399,"type":"sourcemap"}],"sourceType":"module"},"attributes":{},"code":"export class NgxSerial {\n    port;\n    options = { baudRate: 9600, dataBits: 8, parity: 'none', bufferSize: 256, flowControl: 'none' }; //Default\n    writer;\n    readFunction;\n    controlCharacter = \"\\n\";\n    reader;\n    readableStreamClosed;\n    writableStreamClosed;\n    keepReading = true;\n    constructor(readFunction, options, controlCharacter) {\n        this.readFunction = readFunction;\n        if (options)\n            this.options = options;\n        if (controlCharacter)\n            this.controlCharacter = controlCharacter;\n    }\n    async sendData(data) {\n        await this.writer.write(data);\n    }\n    async readLoop() {\n        while (this.port.readable && this.keepReading) {\n            const textDecoder = new TextDecoderStream();\n            this.readableStreamClosed = this.port.readable.pipeTo(textDecoder.writable);\n            this.reader = this.port.readable //textDecoder.readable\n                //.pipeThrough(new TransformStream(new LineBreakTransformer(this.controlCharacter)))\n                .getReader();\n            try {\n                while (true) {\n                    const { value, done } = await this.reader.read();\n                    if (done) {\n                        break;\n                    }\n                    if (value) {\n                        this.readFunction(value);\n                    }\n                }\n            }\n            catch (error) {\n                console.error(\"Read Loop error. Have the serial device been disconnected ? \");\n            }\n        }\n    }\n    async close(callback) {\n        this.keepReading = false;\n        this.reader.cancel();\n        await this.readableStreamClosed.catch(() => { });\n        this.writer.close();\n        await this.writableStreamClosed;\n        await this.port.close();\n        callback(null);\n    }\n    async connect(callback) {\n        this.keepReading = true;\n        if (\"serial\" in navigator) {\n            // The Web Serial API is supported by the browser.\n            let nav = navigator;\n            const ports = await nav.serial.getPorts();\n            try {\n                this.port = await nav.serial.requestPort();\n            }\n            catch (error) {\n                console.error(\"Requesting port error: \" + error);\n                return;\n            }\n            try {\n                await this.port.open(this.options);\n            }\n            catch (error) {\n                console.error(\"Opening port error: \" + error);\n                return;\n            }\n            const textEncoder = new TextEncoderStream();\n            this.writableStreamClosed = textEncoder.readable.pipeTo(this.port.writable);\n            this.writer = textEncoder.writable.getWriter();\n            this.readLoop();\n            callback(this.port);\n        }\n        else {\n            console.error(\"This browser does NOT support the Web Serial API\");\n        }\n    }\n}\nclass LineBreakTransformer {\n    container = \"\";\n    controlCharacter;\n    constructor(controlCharacter) {\n        this.container = '';\n        this.controlCharacter = controlCharacter;\n    }\n    transform(chunk, controller) {\n        this.container += chunk;\n        const lines = this.container.split(this.controlCharacter);\n        this.container = lines.pop();\n        lines.forEach((line) => controller.enqueue(line));\n    }\n    flush(controller) {\n        controller.enqueue(this.container);\n    }\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmd4LXNlcmlhbC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3Byb2plY3RzL25neC1zZXJpYWwvc3JjL2xpYi9uZ3gtc2VyaWFsLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUVBLE1BQU0sT0FBTyxTQUFTO0lBRVYsSUFBSSxDQUFNO0lBQ1YsT0FBTyxHQUFHLEVBQUUsUUFBUSxFQUFFLElBQUksRUFBRSxRQUFRLEVBQUUsQ0FBQyxFQUFFLE1BQU0sRUFBRSxNQUFNLEVBQUUsVUFBVSxFQUFFLEdBQUcsRUFBRSxXQUFXLEVBQUUsTUFBTSxFQUFFLENBQUMsQ0FBQyxTQUFTO0lBQzFHLE1BQU0sQ0FBTTtJQUNaLFlBQVksQ0FBVztJQUN2QixnQkFBZ0IsR0FBVyxJQUFJLENBQUM7SUFDaEMsTUFBTSxDQUFLO0lBQ1gsb0JBQW9CLENBQUs7SUFDekIsb0JBQW9CLENBQUs7SUFDekIsV0FBVyxHQUFXLElBQUksQ0FBQztJQUVuQyxZQUFZLFlBQXNCLEVBQUUsT0FBYSxFQUFFLGdCQUFzQjtRQUN2RSxJQUFJLENBQUMsWUFBWSxHQUFHLFlBQVksQ0FBQztRQUNqQyxJQUFJLE9BQU87WUFDVCxJQUFJLENBQUMsT0FBTyxHQUFHLE9BQU8sQ0FBQztRQUN6QixJQUFJLGdCQUFnQjtZQUNsQixJQUFJLENBQUMsZ0JBQWdCLEdBQUcsZ0JBQWdCLENBQUM7SUFFN0MsQ0FBQztJQUNNLEtBQUssQ0FBQyxRQUFRLENBQUMsSUFBWTtRQUNoQyxNQUFNLElBQUksQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ2hDLENBQUM7SUFFTyxLQUFLLENBQUMsUUFBUTtRQUdwQixPQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsUUFBUSxJQUFJLElBQUksQ0FBQyxXQUFXLEVBQUcsQ0FBQztZQUMvQyxNQUFNLFdBQVcsR0FBRyxJQUFJLGlCQUFpQixFQUFFLENBQUM7WUFDNUMsSUFBSSxDQUFDLG9CQUFvQixHQUFHLElB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QUNwRSxDQUFDO0lBRUgsQ0FBQztDQUNGO0FBRUQsTUFBTSxvQkFBb0I7SUFDeEIsU0FBUyxHQUFNLEVBQUUsQ0FBQztJQUNWLGdCQUFnQixDQUFTO0lBRWpDLFlBQVksZ0JBQXdCO1FBQ2xDLElBQUksQ0FBQyxTQUFTLEdBQUcsRUFBRSxDQUFDO1FBQ3BCLElBQUksQ0FBQyxnQkFBZ0IsR0FBRyxnQkFBZ0IsQ0FBQTtJQUMxQyxDQUFDO0lBRUQsU0FBUyxDQUFDLEtBQVMsRUFBRSxVQUFjO1FBQ2pDLElBQUksQ0FBQyxTQUFTLElBQUksS0FBSyxDQUFDO1FBQ3hCLE1BQU0sS0FBSyxHQUFHLElBQUksQ0FBQyxTQUFTLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO1FBQzFELElBQUksQ0FBQyxTQUFTLEdBQUcsS0FBSyxDQUFDLEdBQUcsRUFBRSxDQUFDO1FBQzdCLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQyxJQUFTLEVBQUUsRUFBRSxDQUFDLFVBQVUsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQztJQUN6RCxDQUFDO0lBRUQsS0FBSyxDQUFDLFVBQWM7UUFDbEIsVUFBVSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUM7SUFDckMsQ0FBQztDQUNGIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTk9ORV9UWVBFIH0gZnJvbSBcIkBhbmd1bGFyL2NvbXBpbGVyXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgTmd4U2VyaWFsIHtcclxuXHJcbiAgICBwcml2YXRlIHBvcnQ6IGFueTtcclxuICAgIHByaXZhdGUgb3B0aW9ucyA9IHsgYmF1ZFJhdGU6IDk2MDAsIGRhdGFCaXRzOiA4LCBwYXJpdHk6ICdub25lJywgYnVmZmVyU2l6ZTogMjU2LCBmbG93Q29udHJvbDogJ25vbmUnIH07IC8vRGVmYXVsdFxyXG4gICAgcHJpdmF0ZSB3cml0ZXI6IGFueTtcclxuICAgIHByaXZhdGUgcmVhZEZ1bmN0aW9uOiBGdW5jdGlvbjtcclxuICAgIHByaXZhdGUgY29udHJvbENoYXJhY3Rlcjogc3RyaW5nID0gXCJcXG5cIjtcclxuICAgIHByaXZhdGUgcmVhZGVyOmFueTtcclxuICAgIHByaXZhdGUgcmVhZGFibGVTdHJlYW1DbG9zZWQ6YW55O1xyXG4gICAgcHJpdmF0ZSB3cml0YWJsZVN0cmVhbUNsb3NlZDphbnk7XHJcbiAgICBwcml2YXRlIGtlZXBSZWFkaW5nOmJvb2xlYW4gPSB0cnVlO1xyXG4gIFxyXG4gICAgY29uc3RydWN0b3IocmVhZEZ1bmN0aW9uOiBGdW5jdGlvbiwgb3B0aW9ucz86IGFueSwgY29udHJvbENoYXJhY3Rlcj86IGFueSkge1xyXG4gICAgICB0aGlzLnJlYWRGdW5jdGlvbiA9IHJlYWRGdW5jdGlvbjtcclxuICAgICAgaWYgKG9wdGlvbnMpXHJcbiAgICAgICAgdGhpcy5vcHRpb25zID0gb3B0aW9ucztcclxuICAgICAgaWYgKGNvbnRyb2xDaGFyYWN0ZXIpXHJcbiAgICAgICAgdGhpcy5jb250cm9sQ2hhcmFjdGVyID0gY29udHJvbENoYXJhY3RlcjtcclxuICBcclxuICAgIH1cclxuICAgIHB1YmxpYyBhc3luYyBzZW5kRGF0YShkYXRhOiBzdHJpbmcpIHtcclxuICAgICAgYXdhaXQgdGhpcy53cml0ZXIud3JpdGUoZGF0YSk7XHJcbiAgICB9XHJcbiAgXHJcbiAgICBwcml2YXRlIGFzeW5jIHJlYWRMb29wKCkge1xyXG4gICAgICBcclxuICBcclxuICAgICAgd2hpbGUgKHRoaXMucG9ydC5yZWFkYWJsZSAmJiB0aGlzLmtlZXBSZWFkaW5nICkge1xyXG4gICAgICAgIGNvbnN0IHRleHREZWNvZGVyID0gbmV3IFRleHREZWNvZGVyU3RyZWFtKCk7XHJcbiAgICAgICAgdGhpcy5yZWFkYWJsZVN0cmVhbUNsb3NlZCA9IHRoaXMucG9ydC5yZWFkYWJsZS5waXBlVG8odGV4dERlY29kZXIud3JpdGFibGUpO1xyXG4gICAgICAgIHRoaXMucmVhZGVyID0gdGhpcy5wb3J0LnJlYWRhYmxlIC8vdGV4dERlY29kZXIucmVhZGFibGVcclxuICAgICAgICAgIC8vLnBpcGVUaHJvdWdoKG5ldyBUcmFuc2Zvcm1TdHJlYW0obmV3IExpbmVCcmVha1RyYW5zZm9ybWVyKHRoaXMuY29udHJvbENoYXJhY3RlcikpKVxyXG4gICAgICAgICAgLmdldFJlYWRlcigpO1xyXG4gIFxyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICB3aGlsZSAodHJ1ZSkge1xyXG4gICAgICAgICAgICBjb25zdCB7IHZhbHVlLCBkb25lIH0gPSBhd2FpdCB0aGlzLnJlYWRlci5yZWFkKCk7XHJcbiAgICAgICAgICAgIGlmIChkb25lKSB7XHJcbiAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgdGhpcy5yZWFkRnVuY3Rpb24odmFsdWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJSZWFkIExvb3AgZXJyb3IuIEhhdmUgdGhlIHNlcmlhbCBkZXZpY2UgYmVlbiBkaXNjb25uZWN0ZWQgPyBcIik7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBwdWJsaWMgYXN5bmMgY2xvc2UoY2FsbGJhY2s6RnVuY3Rpb24pIHtcclxuICAgICAgdGhpcy5rZWVwUmVhZGluZyA9IGZhbHNlO1xyXG4gICAgICB0aGlzLnJlYWRlci5jYW5jZWwoKTtcclxuICAgICAgYXdhaXQgdGhpcy5yZWFkYWJsZVN0cmVhbUNsb3NlZC5jYXRjaCgoKSA9PiB7fSk7XHJcbiAgICAgIHRoaXMud3JpdGVyLmNsb3NlKCk7XHJcbiAgICAgIGF3YWl0IHRoaXMud3JpdGFibGVTdHJlYW1DbG9zZWQ7XHJcbiAgICAgIGF3YWl0IHRoaXMucG9ydC5jbG9zZSgpO1xyXG4gICAgICBjYWxsYmFjayhudWxsKTtcclxuICAgIH1cclxuICBcclxuICAgIHB1YmxpYyBhc3luYyBjb25uZWN0KGNhbGxiYWNrOkZ1bmN0aW9uKSB7XHJcbiAgICAgIHRoaXMua2VlcFJlYWRpbmcgPSB0cnVlO1xyXG4gICAgICBpZiAoXCJzZXJpYWxcIiBpbiBuYXZpZ2F0b3IpIHtcclxuICAgICAgICAvLyBUaGUgV2ViIFNlcmlhbCBBUEkgaXMgc3VwcG9ydGVkIGJ5IHRoZSBicm93c2VyLlxyXG4gICAgICAgIGxldCBuYXY6IGFueSA9IG5hdmlnYXRvcjtcclxuICAgICAgICBjb25zdCBwb3J0cyA9IGF3YWl0IG5hdi5zZXJpYWwuZ2V0UG9ydHMoKTtcclxuICBcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgdGhpcy5wb3J0ID0gYXdhaXQgbmF2LnNlcmlhbC5yZXF1ZXN0UG9ydCgpO1xyXG4gIFxyXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgICBjb25zb2xlLmVycm9yKFwiUmVxdWVzdGluZyBwb3J0IGVycm9yOiBcIiArIGVycm9yKTtcclxuICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgXHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgYXdhaXQgdGhpcy5wb3J0Lm9wZW4odGhpcy5vcHRpb25zKTtcclxuICBcclxuICBcclxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgICAgY29uc29sZS5lcnJvcihcIk9wZW5pbmcgcG9ydCBlcnJvcjogXCIgKyBlcnJvcik7XHJcbiAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gIFxyXG4gICAgICAgIGNvbnN0IHRleHRFbmNvZGVyID0gbmV3IFRleHRFbmNvZGVyU3RyZWFtKCk7XHJcbiAgICAgICAgdGhpcy53cml0YWJsZVN0cmVhbUNsb3NlZCA9IHRleHRFbmNvZGVyLnJlYWRhYmxlLnBpcGVUbyh0aGlzLnBvcnQud3JpdGFibGUpO1xyXG4gICAgICAgIHRoaXMud3JpdGVyID0gdGV4dEVuY29kZXIud3JpdGFibGUuZ2V0V3JpdGVyKCk7XHJcbiAgXHJcbiAgICAgICAgdGhpcy5yZWFkTG9vcCgpO1xyXG4gIFxyXG4gICAgICAgIGNhbGxiYWNrKHRoaXMucG9ydCk7XHJcbiAgXHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihcIlRoaXMgYnJvd3NlciBkb2VzIE5PVCBzdXBwb3J0IHRoZSBXZWIgU2VyaWFsIEFQSVwiKTtcclxuICAgICAgfVxyXG4gIFxyXG4gICAgfVxyXG4gIH1cclxuICBcclxuICBjbGFzcyBMaW5lQnJlYWtUcmFuc2Zvcm1lciB7XHJcbiAgICBjb250YWluZXI6IGFueT1cIlwiO1xyXG4gICAgcHJpdmF0ZSBjb250cm9sQ2hhcmFjdGVyOiBzdHJpbmc7XHJcbiAgXHJcbiAgICBjb25zdHJ1Y3Rvcihjb250cm9sQ2hhcmFjdGVyOiBzdHJpbmcpIHtcclxuICAgICAgdGhpcy5jb250YWluZXIgPSAnJztcclxuICAgICAgdGhpcy5jb250cm9sQ2hhcmFjdGVyID0gY29udHJvbENoYXJhY3RlclxyXG4gICAgfVxyXG4gIFxyXG4gICAgdHJhbnNmb3JtKGNodW5rOmFueSwgY29udHJvbGxlcjphbnkpIHtcclxuICAgICAgdGhpcy5jb250YWluZXIgKz0gY2h1bms7XHJcbiAgICAgIGNvbnN0IGxpbmVzID0gdGhpcy5jb250YWluZXIuc3BsaXQodGhpcy5jb250cm9sQ2hhcmFjdGVyKTtcclxuICAgICAgdGhpcy5jb250YWluZXIgPSBsaW5lcy5wb3AoKTtcclxuICAgICAgbGluZXMuZm9yRWFjaCgobGluZTogYW55KSA9PiBjb250cm9sbGVyLmVucXVldWUobGluZSkpO1xyXG4gICAgfVxyXG4gIFxyXG4gICAgZmx1c2goY29udHJvbGxlcjphbnkpIHtcclxuICAgICAgY29udHJvbGxlci5lbnF1ZXVlKHRoaXMuY29udGFpbmVyKTtcclxuICAgIH1cclxuICB9Il19","customTransformCache":false,"dependencies":[],"id":"C:\\repos\\ngx-serial\\dist\\ngx-serial\\esm2022\\lib\\ngx-serial.mjs","meta":{},"moduleSideEffects":true,"originalCode":"export class NgxSerial {\n    port;\n    options = { baudRate: 9600, dataBits: 8, parity: 'none', bufferSize: 256, flowControl: 'none' }; //Default\n    writer;\n    readFunction;\n    controlCharacter = \"\\n\";\n    reader;\n    readableStreamClosed;\n    writableStreamClosed;\n    keepReading = true;\n    constructor(readFunction, options, controlCharacter) {\n        this.readFunction = readFunction;\n        if (options)\n            this.options = options;\n        if (controlCharacter)\n            this.controlCharacter = controlCharacter;\n    }\n    async sendData(data) {\n        await this.writer.write(data);\n    }\n    async readLoop() {\n        while (this.port.readable && this.keepReading) {\n            const textDecoder = new TextDecoderStream();\n            this.readableStreamClosed = this.port.readable.pipeTo(textDecoder.writable);\n            this.reader = this.port.readable //textDecoder.readable\n                //.pipeThrough(new TransformStream(new LineBreakTransformer(this.controlCharacter)))\n                .getReader();\n            try {\n                while (true) {\n                    const { value, done } = await this.reader.read();\n                    if (done) {\n                        break;\n                    }\n                    if (value) {\n                        this.readFunction(value);\n                    }\n                }\n            }\n            catch (error) {\n                console.error(\"Read Loop error. Have the serial device been disconnected ? \");\n            }\n        }\n    }\n    async close(callback) {\n        this.keepReading = false;\n        this.reader.cancel();\n        await this.readableStreamClosed.catch(() => { });\n        this.writer.close();\n        await this.writableStreamClosed;\n        await this.port.close();\n        callback(null);\n    }\n    async connect(callback) {\n        this.keepReading = true;\n        if (\"serial\" in navigator) {\n            // The Web Serial API is supported by the browser.\n            let nav = navigator;\n            const ports = await nav.serial.getPorts();\n            try {\n                this.port = await nav.serial.requestPort();\n            }\n            catch (error) {\n                console.error(\"Requesting port error: \" + error);\n                return;\n            }\n            try {\n                await this.port.open(this.options);\n            }\n            catch (error) {\n                console.error(\"Opening port error: \" + error);\n                return;\n            }\n            const textEncoder = new TextEncoderStream();\n            this.writableStreamClosed = textEncoder.readable.pipeTo(this.port.writable);\n            this.writer = textEncoder.writable.getWriter();\n            this.readLoop();\n            callback(this.port);\n        }\n        else {\n            console.error(\"This browser does NOT support the Web Serial API\");\n        }\n    }\n}\nclass LineBreakTransformer {\n    container = \"\";\n    controlCharacter;\n    constructor(controlCharacter) {\n        this.container = '';\n        this.controlCharacter = controlCharacter;\n    }\n    transform(chunk, controller) {\n        this.container += chunk;\n        const lines = this.container.split(this.controlCharacter);\n        this.container = lines.pop();\n        lines.forEach((line) => controller.enqueue(line));\n    }\n    flush(controller) {\n        controller.enqueue(this.container);\n    }\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmd4LXNlcmlhbC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3Byb2plY3RzL25neC1zZXJpYWwvc3JjL2xpYi9uZ3gtc2VyaWFsLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUVBLE1BQU0sT0FBTyxTQUFTO0lBRVYsSUFBSSxDQUFNO0lBQ1YsT0FBTyxHQUFHLEVBQUUsUUFBUSxFQUFFLElBQUksRUFBRSxRQUFRLEVBQUUsQ0FBQyxFQUFFLE1BQU0sRUFBRSxNQUFNLEVBQUUsVUFBVSxFQUFFLEdBQUcsRUFBRSxXQUFXLEVBQUUsTUFBTSxFQUFFLENBQUMsQ0FBQyxTQUFTO0lBQzFHLE1BQU0sQ0FBTTtJQUNaLFlBQVksQ0FBVztJQUN2QixnQkFBZ0IsR0FBVyxJQUFJLENBQUM7SUFDaEMsTUFBTSxDQUFLO0lBQ1gsb0JBQW9CLENBQUs7SUFDekIsb0JBQW9CLENBQUs7SUFDekIsV0FBVyxHQUFXLElBQUksQ0FBQztJQUVuQyxZQUFZLFlBQXNCLEVBQUUsT0FBYSxFQUFFLGdCQUFzQjtRQUN2RSxJQUFJLENBQUMsWUFBWSxHQUFHLFlBQVksQ0FBQztRQUNqQyxJQUFJLE9BQU87WUFDVCxJQUFJLENBQUMsT0FBTyxHQUFHLE9BQU8sQ0FBQztRQUN6QixJQUFJLGdCQUFnQjtZQUNsQixJQUFJLENBQUMsZ0JBQWdCLEdBQUcsZ0JBQWdCLENBQUM7SUFFN0MsQ0FBQztJQUNNLEtBQUssQ0FBQyxRQUFRLENBQUMsSUFBWTtRQUNoQyxNQUFNLElBQUksQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ2hDLENBQUM7SUFFTyxLQUFLLENBQUMsUUFBUTtRQUdwQixPQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsUUFBUSxJQUFJLElBQUksQ0FBQyxXQUFXLEVBQUcsQ0FBQztZQUMvQyxNQUFNLFdBQVcsR0FBRyxJQUFJLGlCQUFpQixFQUFFLENBQUM7WUFDNUMsSUFBSSxDQUFDLG9CQUFvQixHQUFHLElB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QUNwRSxDQUFDO0lBRUgsQ0FBQztDQUNGO0FBRUQsTUFBTSxvQkFBb0I7SUFDeEIsU0FBUyxHQUFNLEVBQUUsQ0FBQztJQUNWLGdCQUFnQixDQUFTO0lBRWpDLFlBQVksZ0JBQXdCO1FBQ2xDLElBQUksQ0FBQyxTQUFTLEdBQUcsRUFBRSxDQUFDO1FBQ3BCLElBQUksQ0FBQyxnQkFBZ0IsR0FBRyxnQkFBZ0IsQ0FBQTtJQUMxQyxDQUFDO0lBRUQsU0FBUyxDQUFDLEtBQVMsRUFBRSxVQUFjO1FBQ2pDLElBQUksQ0FBQyxTQUFTLElBQUksS0FBSyxDQUFDO1FBQ3hCLE1BQU0sS0FBSyxHQUFHLElBQUksQ0FBQyxTQUFTLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO1FBQzFELElBQUksQ0FBQyxTQUFTLEdBQUcsS0FBSyxDQUFDLEdBQUcsRUFBRSxDQUFDO1FBQzdCLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQyxJQUFTLEVBQUUsRUFBRSxDQUFDLFVBQVUsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQztJQUN6RCxDQUFDO0lBRUQsS0FBSyxDQUFDLFVBQWM7UUFDbEIsVUFBVSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUM7SUFDckMsQ0FBQztDQUNGIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTk9ORV9UWVBFIH0gZnJvbSBcIkBhbmd1bGFyL2NvbXBpbGVyXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgTmd4U2VyaWFsIHtcclxuXHJcbiAgICBwcml2YXRlIHBvcnQ6IGFueTtcclxuICAgIHByaXZhdGUgb3B0aW9ucyA9IHsgYmF1ZFJhdGU6IDk2MDAsIGRhdGFCaXRzOiA4LCBwYXJpdHk6ICdub25lJywgYnVmZmVyU2l6ZTogMjU2LCBmbG93Q29udHJvbDogJ25vbmUnIH07IC8vRGVmYXVsdFxyXG4gICAgcHJpdmF0ZSB3cml0ZXI6IGFueTtcclxuICAgIHByaXZhdGUgcmVhZEZ1bmN0aW9uOiBGdW5jdGlvbjtcclxuICAgIHByaXZhdGUgY29udHJvbENoYXJhY3Rlcjogc3RyaW5nID0gXCJcXG5cIjtcclxuICAgIHByaXZhdGUgcmVhZGVyOmFueTtcclxuICAgIHByaXZhdGUgcmVhZGFibGVTdHJlYW1DbG9zZWQ6YW55O1xyXG4gICAgcHJpdmF0ZSB3cml0YWJsZVN0cmVhbUNsb3NlZDphbnk7XHJcbiAgICBwcml2YXRlIGtlZXBSZWFkaW5nOmJvb2xlYW4gPSB0cnVlO1xyXG4gIFxyXG4gICAgY29uc3RydWN0b3IocmVhZEZ1bmN0aW9uOiBGdW5jdGlvbiwgb3B0aW9ucz86IGFueSwgY29udHJvbENoYXJhY3Rlcj86IGFueSkge1xyXG4gICAgICB0aGlzLnJlYWRGdW5jdGlvbiA9IHJlYWRGdW5jdGlvbjtcclxuICAgICAgaWYgKG9wdGlvbnMpXHJcbiAgICAgICAgdGhpcy5vcHRpb25zID0gb3B0aW9ucztcclxuICAgICAgaWYgKGNvbnRyb2xDaGFyYWN0ZXIpXHJcbiAgICAgICAgdGhpcy5jb250cm9sQ2hhcmFjdGVyID0gY29udHJvbENoYXJhY3RlcjtcclxuICBcclxuICAgIH1cclxuICAgIHB1YmxpYyBhc3luYyBzZW5kRGF0YShkYXRhOiBzdHJpbmcpIHtcclxuICAgICAgYXdhaXQgdGhpcy53cml0ZXIud3JpdGUoZGF0YSk7XHJcbiAgICB9XHJcbiAgXHJcbiAgICBwcml2YXRlIGFzeW5jIHJlYWRMb29wKCkge1xyXG4gICAgICBcclxuICBcclxuICAgICAgd2hpbGUgKHRoaXMucG9ydC5yZWFkYWJsZSAmJiB0aGlzLmtlZXBSZWFkaW5nICkge1xyXG4gICAgICAgIGNvbnN0IHRleHREZWNvZGVyID0gbmV3IFRleHREZWNvZGVyU3RyZWFtKCk7XHJcbiAgICAgICAgdGhpcy5yZWFkYWJsZVN0cmVhbUNsb3NlZCA9IHRoaXMucG9ydC5yZWFkYWJsZS5waXBlVG8odGV4dERlY29kZXIud3JpdGFibGUpO1xyXG4gICAgICAgIHRoaXMucmVhZGVyID0gdGhpcy5wb3J0LnJlYWRhYmxlIC8vdGV4dERlY29kZXIucmVhZGFibGVcclxuICAgICAgICAgIC8vLnBpcGVUaHJvdWdoKG5ldyBUcmFuc2Zvcm1TdHJlYW0obmV3IExpbmVCcmVha1RyYW5zZm9ybWVyKHRoaXMuY29udHJvbENoYXJhY3RlcikpKVxyXG4gICAgICAgICAgLmdldFJlYWRlcigpO1xyXG4gIFxyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICB3aGlsZSAodHJ1ZSkge1xyXG4gICAgICAgICAgICBjb25zdCB7IHZhbHVlLCBkb25lIH0gPSBhd2FpdCB0aGlzLnJlYWRlci5yZWFkKCk7XHJcbiAgICAgICAgICAgIGlmIChkb25lKSB7XHJcbiAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgdGhpcy5yZWFkRnVuY3Rpb24odmFsdWUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJSZWFkIExvb3AgZXJyb3IuIEhhdmUgdGhlIHNlcmlhbCBkZXZpY2UgYmVlbiBkaXNjb25uZWN0ZWQgPyBcIik7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBwdWJsaWMgYXN5bmMgY2xvc2UoY2FsbGJhY2s6RnVuY3Rpb24pIHtcclxuICAgICAgdGhpcy5rZWVwUmVhZGluZyA9IGZhbHNlO1xyXG4gICAgICB0aGlzLnJlYWRlci5jYW5jZWwoKTtcclxuICAgICAgYXdhaXQgdGhpcy5yZWFkYWJsZVN0cmVhbUNsb3NlZC5jYXRjaCgoKSA9PiB7fSk7XHJcbiAgICAgIHRoaXMud3JpdGVyLmNsb3NlKCk7XHJcbiAgICAgIGF3YWl0IHRoaXMud3JpdGFibGVTdHJlYW1DbG9zZWQ7XHJcbiAgICAgIGF3YWl0IHRoaXMucG9ydC5jbG9zZSgpO1xyXG4gICAgICBjYWxsYmFjayhudWxsKTtcclxuICAgIH1cclxuICBcclxuICAgIHB1YmxpYyBhc3luYyBjb25uZWN0KGNhbGxiYWNrOkZ1bmN0aW9uKSB7XHJcbiAgICAgIHRoaXMua2VlcFJlYWRpbmcgPSB0cnVlO1xyXG4gICAgICBpZiAoXCJzZXJpYWxcIiBpbiBuYXZpZ2F0b3IpIHtcclxuICAgICAgICAvLyBUaGUgV2ViIFNlcmlhbCBBUEkgaXMgc3VwcG9ydGVkIGJ5IHRoZSBicm93c2VyLlxyXG4gICAgICAgIGxldCBuYXY6IGFueSA9IG5hdmlnYXRvcjtcclxuICAgICAgICBjb25zdCBwb3J0cyA9IGF3YWl0IG5hdi5zZXJpYWwuZ2V0UG9ydHMoKTtcclxuICBcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgdGhpcy5wb3J0ID0gYXdhaXQgbmF2LnNlcmlhbC5yZXF1ZXN0UG9ydCgpO1xyXG4gIFxyXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgICBjb25zb2xlLmVycm9yKFwiUmVxdWVzdGluZyBwb3J0IGVycm9yOiBcIiArIGVycm9yKTtcclxuICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgXHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgYXdhaXQgdGhpcy5wb3J0Lm9wZW4odGhpcy5vcHRpb25zKTtcclxuICBcclxuICBcclxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgICAgY29uc29sZS5lcnJvcihcIk9wZW5pbmcgcG9ydCBlcnJvcjogXCIgKyBlcnJvcik7XHJcbiAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gIFxyXG4gICAgICAgIGNvbnN0IHRleHRFbmNvZGVyID0gbmV3IFRleHRFbmNvZGVyU3RyZWFtKCk7XHJcbiAgICAgICAgdGhpcy53cml0YWJsZVN0cmVhbUNsb3NlZCA9IHRleHRFbmNvZGVyLnJlYWRhYmxlLnBpcGVUbyh0aGlzLnBvcnQud3JpdGFibGUpO1xyXG4gICAgICAgIHRoaXMud3JpdGVyID0gdGV4dEVuY29kZXIud3JpdGFibGUuZ2V0V3JpdGVyKCk7XHJcbiAgXHJcbiAgICAgICAgdGhpcy5yZWFkTG9vcCgpO1xyXG4gIFxyXG4gICAgICAgIGNhbGxiYWNrKHRoaXMucG9ydCk7XHJcbiAgXHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihcIlRoaXMgYnJvd3NlciBkb2VzIE5PVCBzdXBwb3J0IHRoZSBXZWIgU2VyaWFsIEFQSVwiKTtcclxuICAgICAgfVxyXG4gIFxyXG4gICAgfVxyXG4gIH1cclxuICBcclxuICBjbGFzcyBMaW5lQnJlYWtUcmFuc2Zvcm1lciB7XHJcbiAgICBjb250YWluZXI6IGFueT1cIlwiO1xyXG4gICAgcHJpdmF0ZSBjb250cm9sQ2hhcmFjdGVyOiBzdHJpbmc7XHJcbiAgXHJcbiAgICBjb25zdHJ1Y3Rvcihjb250cm9sQ2hhcmFjdGVyOiBzdHJpbmcpIHtcclxuICAgICAgdGhpcy5jb250YWluZXIgPSAnJztcclxuICAgICAgdGhpcy5jb250cm9sQ2hhcmFjdGVyID0gY29udHJvbENoYXJhY3RlclxyXG4gICAgfVxyXG4gIFxyXG4gICAgdHJhbnNmb3JtKGNodW5rOmFueSwgY29udHJvbGxlcjphbnkpIHtcclxuICAgICAgdGhpcy5jb250YWluZXIgKz0gY2h1bms7XHJcbiAgICAgIGNvbnN0IGxpbmVzID0gdGhpcy5jb250YWluZXIuc3BsaXQodGhpcy5jb250cm9sQ2hhcmFjdGVyKTtcclxuICAgICAgdGhpcy5jb250YWluZXIgPSBsaW5lcy5wb3AoKTtcclxuICAgICAgbGluZXMuZm9yRWFjaCgobGluZTogYW55KSA9PiBjb250cm9sbGVyLmVucXVldWUobGluZSkpO1xyXG4gICAgfVxyXG4gIFxyXG4gICAgZmx1c2goY29udHJvbGxlcjphbnkpIHtcclxuICAgICAgY29udHJvbGxlci5lbnF1ZXVlKHRoaXMuY29udGFpbmVyKTtcclxuICAgIH1cclxuICB9Il19","originalSourcemap":{"version":3,"file":"ngx-serial.js","sourceRoot":"","sources":["../../../../projects/ngx-serial/src/lib/ngx-serial.ts"],"names":[],"mappings":[[[0,0,2,0],[6,0,2,6],[13,0,2,13],[22,0,2,22]],[[4,0,4,12],[8,0,4,16],[9,0,4,22]],[[4,0,5,12],[11,0,5,19],[14,0,5,22],[16,0,5,24],[24,0,5,32],[26,0,5,34],[30,0,5,38],[32,0,5,40],[40,0,5,48],[42,0,5,50],[43,0,5,51],[45,0,5,53],[51,0,5,59],[53,0,5,61],[59,0,5,67],[61,0,5,69],[71,0,5,79],[73,0,5,81],[76,0,5,84],[78,0,5,86],[89,0,5,97],[91,0,5,99],[97,0,5,105],[99,0,5,107],[100,0,5,108],[101,0,5,109],[110,0,5,118]],[[4,0,6,12],[10,0,6,18],[11,0,6,24]],[[4,0,7,12],[16,0,7,24],[17,0,7,35]],[[4,0,8,12],[20,0,8,28],[23,0,8,39],[27,0,8,43],[28,0,8,44]],[[4,0,9,12],[10,0,9,18],[11,0,9,23]],[[4,0,10,12],[24,0,10,32],[25,0,10,37]],[[4,0,11,12],[24,0,11,32],[25,0,11,37]],[[4,0,12,12],[15,0,12,23],[18,0,12,34],[22,0,12,38],[23,0,12,39]],[[4,0,14,4],[16,0,14,16],[28,0,14,38],[30,0,14,40],[37,0,14,53],[39,0,14,55],[55,0,14,77]],[[8,0,15,6],[12,0,15,10],[13,0,15,11],[25,0,15,23],[28,0,15,26],[40,0,15,38],[41,0,15,39]],[[8,0,16,6],[12,0,16,10],[19,0,16,17]],[[12,0,17,8],[16,0,17,12],[17,0,17,13],[24,0,17,20],[27,0,17,23],[34,0,17,30],[35,0,17,31]],[[8,0,18,6],[12,0,18,10],[28,0,18,26]],[[12,0,19,8],[16,0,19,12],[17,0,19,13],[33,0,19,29],[36,0,19,32],[52,0,19,48],[53,0,19,49]],[[4,0,21,4],[5,0,21,5]],[[4,0,22,11],[9,0,22,16],[10,0,22,17],[18,0,22,25],[19,0,22,26],[23,0,22,38]],[[8,0,23,6],[14,0,23,12],[18,0,23,16],[19,0,23,17],[25,0,23,23],[26,0,23,24],[31,0,23,29],[32,0,23,30],[36,0,23,34],[37,0,23,35],[38,0,23,36]],[[4,0,24,4],[5,0,24,5]],[[4,0,26,12],[9,0,26,17],[10,0,26,18],[18,0,26,26]],[[8,0,29,6],[15,0,29,13],[19,0,29,17],[20,0,29,18],[24,0,29,22],[25,0,29,23],[33,0,29,31],[37,0,29,35],[41,0,29,39],[42,0,29,40],[53,0,29,51],[55,0,29,54],[56,0,29,55]],[[12,0,30,8],[18,0,30,14],[29,0,30,25],[32,0,30,28],[36,0,30,32],[53,0,30,49],[55,0,30,51],[56,0,30,52]],[[12,0,31,8],[16,0,31,12],[17,0,31,13],[37,0,31,33],[40,0,31,36],[44,0,31,40],[45,0,31,41],[49,0,31,45],[50,0,31,46],[58,0,31,54],[59,0,31,55],[65,0,31,61],[66,0,31,62],[77,0,31,73],[78,0,31,74],[86,0,31,82],[87,0,31,83],[88,0,31,84]],[[12,0,32,8],[16,0,32,12],[17,0,32,13],[23,0,32,19],[26,0,32,22],[30,0,32,26],[31,0,32,27],[35,0,32,31],[36,0,32,32],[44,0,32,40],[45,0,32,41],[67,0,32,63]],[[16,0,33,10],[100,0,33,94]],[[17,0,34,11],[26,0,34,20],[28,0,34,22],[29,0,34,23]],[[12,0,36,8],[16,0,36,12],[17,0,36,13]],[[16,0,37,10],[23,0,37,17],[27,0,37,21],[29,0,37,23],[30,0,37,24]],[[20,0,38,12],[26,0,38,18],[28,0,38,20],[33,0,38,25],[35,0,38,27],[39,0,38,31],[41,0,38,33],[44,0,38,36],[50,0,38,42],[54,0,38,46],[55,0,38,47],[61,0,38,53],[62,0,38,54],[66,0,38,58],[68,0,38,60],[69,0,38,61]],[[20,0,39,12],[24,0,39,16],[28,0,39,20],[30,0,39,22],[31,0,39,23]],[[24,0,40,14],[30,0,40,20]],[[20,0,41,12],[21,0,41,13]],[[20,0,42,12],[24,0,42,16],[29,0,42,21],[31,0,42,23],[32,0,42,24]],[[24,0,43,14],[28,0,43,18],[29,0,43,19],[41,0,43,31],[42,0,43,32],[47,0,43,37],[48,0,43,38],[49,0,43,39]],[[20,0,44,12],[21,0,44,13]],[[16,0,45,10],[17,0,45,11]],[[12,0,46,8],[13,0,46,9]],[[12,0,46,10],[19,0,46,17],[24,0,46,22],[26,0,46,24],[27,0,46,25]],[[16,0,47,10],[23,0,47,17],[24,0,47,18],[29,0,47,23],[30,0,47,24],[92,0,47,86],[93,0,47,87],[94,0,47,88]],[[12,0,48,8],[13,0,48,9]],[[8,0,49,6],[9,0,49,7]],[[4,0,50,4],[5,0,50,5]],[[4,0,51,11],[9,0,51,16],[10,0,51,17],[15,0,51,22],[16,0,51,23],[24,0,51,40]],[[8,0,52,6],[12,0,52,10],[13,0,52,11],[24,0,52,22],[27,0,52,25],[32,0,52,30],[33,0,52,31]],[[8,0,53,6],[12,0,53,10],[13,0,53,11],[19,0,53,17],[20,0,53,18],[26,0,53,24],[28,0,53,26],[29,0,53,27]],[[8,0,54,6],[14,0,54,12],[18,0,54,16],[19,0,54,17],[39,0,54,37],[40,0,54,38],[45,0,54,43],[46,0,54,44],[49,0,54,47],[51,0,54,49],[54,0,54,51],[55,0,54,52],[56,0,54,53],[57,0,54,54]],[[8,0,55,6],[12,0,55,10],[13,0,55,11],[19,0,55,17],[20,0,55,18],[25,0,55,23],[27,0,55,25],[28,0,55,26]],[[8,0,56,6],[14,0,56,12],[18,0,56,16],[19,0,56,17],[39,0,56,37],[40,0,56,38]],[[8,0,57,6],[14,0,57,12],[18,0,57,16],[19,0,57,17],[23,0,57,21],[24,0,57,22],[29,0,57,27],[31,0,57,29],[32,0,57,30]],[[8,0,58,6],[16,0,58,14],[17,0,58,15],[21,0,58,19],[22,0,58,20],[23,0,58,21]],[[4,0,59,4],[5,0,59,5]],[[4,0,61,11],[9,0,61,16],[10,0,61,17],[17,0,61,24],[18,0,61,25],[26,0,61,42]],[[8,0,62,6],[12,0,62,10],[13,0,62,11],[24,0,62,22],[27,0,62,25],[31,0,62,29],[32,0,62,30]],[[8,0,63,6],[12,0,63,10],[20,0,63,18],[24,0,63,22],[33,0,63,31],[35,0,63,33],[36,0,63,34]],[[12,0,64,8],[62,0,64,58]],[[12,0,65,8],[16,0,65,12],[19,0,65,15],[22,0,65,23],[31,0,65,32],[32,0,65,33]],[[12,0,66,8],[18,0,66,14],[23,0,66,19],[26,0,66,22],[32,0,66,28],[35,0,66,31],[36,0,66,32],[42,0,66,38],[43,0,66,39],[51,0,66,47],[53,0,66,49],[54,0,66,50]],[[12,0,68,8],[16,0,68,12],[17,0,68,13]],[[16,0,69,10],[20,0,69,14],[21,0,69,15],[25,0,69,19],[28,0,69,22],[34,0,69,28],[37,0,69,31],[38,0,69,32],[44,0,69,38],[45,0,69,39],[56,0,69,50],[58,0,69,52],[59,0,69,53]],[[12,0,71,8],[13,0,71,9]],[[12,0,71,10],[19,0,71,17],[24,0,71,22],[26,0,71,24],[27,0,71,25]],[[16,0,72,10],[23,0,72,17],[24,0,72,18],[29,0,72,23],[30,0,72,24],[55,0,72,49],[58,0,72,52],[63,0,72,57],[64,0,72,58],[65,0,72,59]],[[16,0,73,10],[23,0,73,17]],[[12,0,74,8],[13,0,74,9]],[[12,0,76,8],[16,0,76,12],[17,0,76,13]],[[16,0,77,9],[22,0,77,15],[26,0,77,19],[27,0,77,20],[31,0,77,24],[32,0,77,25],[36,0,77,29],[37,0,77,30],[41,0,77,34],[42,0,77,35],[49,0,77,42],[50,0,77,43],[51,0,77,44]],[[12,0,80,8],[13,0,80,9]],[[12,0,80,10],[19,0,80,17],[24,0,80,22],[26,0,80,24],[27,0,80,25]],[[16,0,81,10],[23,0,81,17],[24,0,81,18],[29,0,81,23],[30,0,81,24],[52,0,81,46],[55,0,81,49],[60,0,81,54],[61,0,81,55],[62,0,81,56]],[[16,0,82,10],[23,0,82,17]],[[12,0,83,8],[13,0,83,9]],[[12,0,85,8],[18,0,85,14],[29,0,85,25],[32,0,85,28],[36,0,85,32],[53,0,85,49],[55,0,85,51],[56,0,85,52]],[[12,0,86,8],[16,0,86,12],[17,0,86,13],[37,0,86,33],[40,0,86,36],[51,0,86,47],[52,0,86,48],[60,0,86,56],[61,0,86,57],[67,0,86,63],[68,0,86,64],[72,0,86,68],[73,0,86,69],[77,0,86,73],[78,0,86,74],[86,0,86,82],[87,0,86,83],[88,0,86,84]],[[12,0,87,8],[16,0,87,12],[17,0,87,13],[23,0,87,19],[26,0,87,22],[37,0,87,33],[38,0,87,34],[46,0,87,42],[47,0,87,43],[56,0,87,52],[58,0,87,54],[59,0,87,55]],[[12,0,89,8],[16,0,89,12],[17,0,89,13],[25,0,89,21],[27,0,89,23],[28,0,89,24]],[[12,0,91,8],[20,0,91,16],[21,0,91,17],[25,0,91,21],[26,0,91,22],[30,0,91,26],[31,0,91,27],[32,0,91,28]],[[8,0,93,6],[9,0,93,7]],[[13,0,93,13],[14,0,93,14]],[[12,0,94,8],[19,0,94,15],[20,0,94,16],[25,0,94,21],[26,0,94,22],[76,0,94,72],[77,0,94,73],[78,0,94,74]],[[8,0,95,6],[9,0,95,7]],[[4,0,97,4],[5,0,97,5]],[[1,0,98,3]],[[0,0,100,2],[6,0,100,8],[26,0,100,28]],[[4,0,101,4],[13,0,101,13],[16,0,101,19],[18,0,101,21],[19,0,101,22]],[[4,0,102,12],[20,0,102,28],[21,0,102,37]],[[4,0,104,4],[16,0,104,16],[32,0,104,40]],[[8,0,105,6],[12,0,105,10],[13,0,105,11],[22,0,105,20],[25,0,105,23],[27,0,105,25],[28,0,105,26]],[[8,0,106,6],[12,0,106,10],[13,0,106,11],[29,0,106,27],[32,0,106,30],[48,0,106,46],[49,0,106,46]],[[4,0,107,4],[5,0,107,5]],[[4,0,109,4],[13,0,109,13],[14,0,109,14],[19,0,109,23],[21,0,109,25],[31,0,109,39]],[[8,0,110,6],[12,0,110,10],[13,0,110,11],[22,0,110,20],[26,0,110,24],[31,0,110,29],[32,0,110,30]],[[8,0,111,6],[14,0,111,12],[19,0,111,17],[22,0,111,20],[26,0,111,24],[27,0,111,25],[36,0,111,34],[37,0,111,35],[42,0,111,40],[43,0,111,41],[47,0,111,45],[48,0,111,46],[64,0,111,62],[65,0,111,63],[66,0,111,64]],[[8,0,112,6],[12,0,112,10],[13,0,112,11],[22,0,112,20],[25,0,112,23],[30,0,112,28],[31,0,112,29],[34,0,112,32],[36,0,112,34],[37,0,112,35]],[[8,0,113,6],[13,0,113,11],[14,0,113,12],[21,0,113,19],[22,0,113,20],[23,0,113,21],[27,0,113,30],[29,0,113,32],[31,0,113,34],[32,0,113,35],[42,0,113,45],[43,0,113,46],[50,0,113,53],[51,0,113,54],[55,0,113,58],[56,0,113,59],[57,0,113,60],[58,0,113,61]],[[4,0,114,4],[5,0,114,5]],[[4,0,116,4],[9,0,116,9],[10,0,116,10],[20,0,116,24]],[[8,0,117,6],[18,0,117,16],[19,0,117,17],[26,0,117,24],[27,0,117,25],[31,0,117,29],[32,0,117,30],[41,0,117,39],[42,0,117,40],[43,0,117,41]],[[4,0,118,4],[5,0,118,5]],[[1,0,119,3]]],"sourcesContent":["import { NONE_TYPE } from \"@angular/compiler\";\r\n\r\nexport class NgxSerial {\r\n\r\n    private port: any;\r\n    private options = { baudRate: 9600, dataBits: 8, parity: 'none', bufferSize: 256, flowControl: 'none' }; //Default\r\n    private writer: any;\r\n    private readFunction: Function;\r\n    private controlCharacter: string = \"\\n\";\r\n    private reader:any;\r\n    private readableStreamClosed:any;\r\n    private writableStreamClosed:any;\r\n    private keepReading:boolean = true;\r\n  \r\n    constructor(readFunction: Function, options?: any, controlCharacter?: any) {\r\n      this.readFunction = readFunction;\r\n      if (options)\r\n        this.options = options;\r\n      if (controlCharacter)\r\n        this.controlCharacter = controlCharacter;\r\n  \r\n    }\r\n    public async sendData(data: string) {\r\n      await this.writer.write(data);\r\n    }\r\n  \r\n    private async readLoop() {\r\n      \r\n  \r\n      while (this.port.readable && this.keepReading ) {\r\n        const textDecoder = new TextDecoderStream();\r\n        this.readableStreamClosed = this.port.readable.pipeTo(textDecoder.writable);\r\n        this.reader = this.port.readable //textDecoder.readable\r\n          //.pipeThrough(new TransformStream(new LineBreakTransformer(this.controlCharacter)))\r\n          .getReader();\r\n  \r\n        try {\r\n          while (true) {\r\n            const { value, done } = await this.reader.read();\r\n            if (done) {\r\n              break;\r\n            }\r\n            if (value) {\r\n              this.readFunction(value);\r\n            }\r\n          }\r\n        } catch (error) {\r\n          console.error(\"Read Loop error. Have the serial device been disconnected ? \");\r\n        }\r\n      }\r\n    }\r\n    public async close(callback:Function) {\r\n      this.keepReading = false;\r\n      this.reader.cancel();\r\n      await this.readableStreamClosed.catch(() => {});\r\n      this.writer.close();\r\n      await this.writableStreamClosed;\r\n      await this.port.close();\r\n      callback(null);\r\n    }\r\n  \r\n    public async connect(callback:Function) {\r\n      this.keepReading = true;\r\n      if (\"serial\" in navigator) {\r\n        // The Web Serial API is supported by the browser.\r\n        let nav: any = navigator;\r\n        const ports = await nav.serial.getPorts();\r\n  \r\n        try {\r\n          this.port = await nav.serial.requestPort();\r\n  \r\n        } catch (error) {\r\n          console.error(\"Requesting port error: \" + error);\r\n          return;\r\n        }\r\n  \r\n        try {\r\n         await this.port.open(this.options);\r\n  \r\n  \r\n        } catch (error) {\r\n          console.error(\"Opening port error: \" + error);\r\n          return;\r\n        }\r\n  \r\n        const textEncoder = new TextEncoderStream();\r\n        this.writableStreamClosed = textEncoder.readable.pipeTo(this.port.writable);\r\n        this.writer = textEncoder.writable.getWriter();\r\n  \r\n        this.readLoop();\r\n  \r\n        callback(this.port);\r\n  \r\n      } else {\r\n        console.error(\"This browser does NOT support the Web Serial API\");\r\n      }\r\n  \r\n    }\r\n  }\r\n  \r\n  class LineBreakTransformer {\r\n    container: any=\"\";\r\n    private controlCharacter: string;\r\n  \r\n    constructor(controlCharacter: string) {\r\n      this.container = '';\r\n      this.controlCharacter = controlCharacter\r\n    }\r\n  \r\n    transform(chunk:any, controller:any) {\r\n      this.container += chunk;\r\n      const lines = this.container.split(this.controlCharacter);\r\n      this.container = lines.pop();\r\n      lines.forEach((line: any) => controller.enqueue(line));\r\n    }\r\n  \r\n    flush(controller:any) {\r\n      controller.enqueue(this.container);\r\n    }\r\n  }"]},"resolvedIds":{},"sourcemapChain":[],"syntheticNamedExports":false,"transformDependencies":[]},{"ast":{"type":"Program","start":0,"end":846,"body":[{"type":"ExportAllDeclaration","start":174,"end":207,"exported":null,"source":{"type":"Literal","start":188,"end":206,"value":"./lib/ngx-serial","raw":"'./lib/ngx-serial'"},"attributes":[]}],"_rollupRemoved":[{"end":846,"start":208,"type":"sourcemap"}],"sourceType":"module"},"attributes":{},"code":"/*\n * Public API Surface of ngx-serial\n */\n/*export * from './lib/ngx-serial.service';\nexport * from './lib/ngx-serial.component';\nexport * from './lib/ngx-serial.module';*/\nexport * from './lib/ngx-serial';\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicHVibGljLWFwaS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3Byb2plY3RzL25neC1zZXJpYWwvc3JjL3B1YmxpYy1hcGkudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7O0dBRUc7QUFFSDs7MENBRTBDO0FBQzFDLGNBQWMsa0JBQWtCLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyIvKlxyXG4gKiBQdWJsaWMgQVBJIFN1cmZhY2Ugb2Ygbmd4LXNlcmlhbFxyXG4gKi9cclxuXHJcbi8qZXhwb3J0ICogZnJvbSAnLi9saWIvbmd4LXNlcmlhbC5zZXJ2aWNlJztcclxuZXhwb3J0ICogZnJvbSAnLi9saWIvbmd4LXNlcmlhbC5jb21wb25lbnQnO1xyXG5leHBvcnQgKiBmcm9tICcuL2xpYi9uZ3gtc2VyaWFsLm1vZHVsZSc7Ki9cclxuZXhwb3J0ICogZnJvbSAnLi9saWIvbmd4LXNlcmlhbCc7XHJcbiJdfQ==","customTransformCache":false,"dependencies":["C:\\repos\\ngx-serial\\dist\\ngx-serial\\esm2022\\lib\\ngx-serial.mjs"],"id":"C:\\repos\\ngx-serial\\dist\\ngx-serial\\esm2022\\public-api.mjs","meta":{},"moduleSideEffects":true,"originalCode":"/*\n * Public API Surface of ngx-serial\n */\n/*export * from './lib/ngx-serial.service';\nexport * from './lib/ngx-serial.component';\nexport * from './lib/ngx-serial.module';*/\nexport * from './lib/ngx-serial';\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicHVibGljLWFwaS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3Byb2plY3RzL25neC1zZXJpYWwvc3JjL3B1YmxpYy1hcGkudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7O0dBRUc7QUFFSDs7MENBRTBDO0FBQzFDLGNBQWMsa0JBQWtCLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyIvKlxyXG4gKiBQdWJsaWMgQVBJIFN1cmZhY2Ugb2Ygbmd4LXNlcmlhbFxyXG4gKi9cclxuXHJcbi8qZXhwb3J0ICogZnJvbSAnLi9saWIvbmd4LXNlcmlhbC5zZXJ2aWNlJztcclxuZXhwb3J0ICogZnJvbSAnLi9saWIvbmd4LXNlcmlhbC5jb21wb25lbnQnO1xyXG5leHBvcnQgKiBmcm9tICcuL2xpYi9uZ3gtc2VyaWFsLm1vZHVsZSc7Ki9cclxuZXhwb3J0ICogZnJvbSAnLi9saWIvbmd4LXNlcmlhbCc7XHJcbiJdfQ==","originalSourcemap":{"version":3,"file":"public-api.js","sourceRoot":"","sources":["../../../projects/ngx-serial/src/public-api.ts"],"names":[],"mappings":[[[0,0,0,0]],[],[[3,0,2,3]],[[0,0,4,0]],[],[[42,0,6,42]],[[0,0,7,0],[14,0,7,14],[32,0,7,32],[33,0,7,33]]],"sourcesContent":["/*\r\n * Public API Surface of ngx-serial\r\n */\r\n\r\n/*export * from './lib/ngx-serial.service';\r\nexport * from './lib/ngx-serial.component';\r\nexport * from './lib/ngx-serial.module';*/\r\nexport * from './lib/ngx-serial';\r\n"]},"resolvedIds":{"./lib/ngx-serial":{"attributes":{},"external":false,"id":"C:\\repos\\ngx-serial\\dist\\ngx-serial\\esm2022\\lib\\ngx-serial.mjs","meta":{},"moduleSideEffects":true,"resolvedBy":"node-resolve","syntheticNamedExports":false}},"sourcemapChain":[],"syntheticNamedExports":false,"transformDependencies":[]},{"ast":{"type":"Program","start":0,"end":496,"body":[{"type":"ExportAllDeclaration","start":48,"end":77,"exported":null,"source":{"type":"Literal","start":62,"end":76,"value":"./public-api","raw":"'./public-api'"},"attributes":[]}],"_rollupRemoved":[{"end":496,"start":78,"type":"sourcemap"}],"sourceType":"module"},"attributes":{},"code":"/**\n * Generated bundle index. Do not edit.\n */\nexport * from './public-api';\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmd4LXNlcmlhbC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3Byb2plY3RzL25neC1zZXJpYWwvc3JjL25neC1zZXJpYWwudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7O0dBRUc7QUFFSCxjQUFjLGNBQWMsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogR2VuZXJhdGVkIGJ1bmRsZSBpbmRleC4gRG8gbm90IGVkaXQuXG4gKi9cblxuZXhwb3J0ICogZnJvbSAnLi9wdWJsaWMtYXBpJztcbiJdfQ==","customTransformCache":false,"dependencies":["C:\\repos\\ngx-serial\\dist\\ngx-serial\\esm2022\\public-api.mjs"],"id":"C:\\repos\\ngx-serial\\dist\\ngx-serial\\esm2022\\ngx-serial.mjs","meta":{},"moduleSideEffects":true,"originalCode":"/**\n * Generated bundle index. Do not edit.\n */\nexport * from './public-api';\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmd4LXNlcmlhbC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3Byb2plY3RzL25neC1zZXJpYWwvc3JjL25neC1zZXJpYWwudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7O0dBRUc7QUFFSCxjQUFjLGNBQWMsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogR2VuZXJhdGVkIGJ1bmRsZSBpbmRleC4gRG8gbm90IGVkaXQuXG4gKi9cblxuZXhwb3J0ICogZnJvbSAnLi9wdWJsaWMtYXBpJztcbiJdfQ==","originalSourcemap":{"version":3,"file":"ngx-serial.js","sourceRoot":"","sources":["../../../projects/ngx-serial/src/ngx-serial.ts"],"names":[],"mappings":[[[0,0,0,0]],[],[[3,0,2,3]],[[0,0,4,0],[14,0,4,14],[28,0,4,28],[29,0,4,29]]],"sourcesContent":["/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n"]},"resolvedIds":{"./public-api":{"attributes":{},"external":false,"id":"C:\\repos\\ngx-serial\\dist\\ngx-serial\\esm2022\\public-api.mjs","meta":{},"moduleSideEffects":true,"resolvedBy":"node-resolve","syntheticNamedExports":false}},"sourcemapChain":[],"syntheticNamedExports":false,"transformDependencies":[]}],"plugins":{"node-resolve":{},"json":{},"file-loader":{}}}